<link rel='stylesheet' href='what.css' type='text/css' />
<h3>NAME</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;<span&nbsp;class='name'>_GetOpt&nbsp;--&nbsp;<span&nbsp;class='description'>Parse&nbsp;command&nbsp;line&nbsp;options&nbsp;and&nbsp;create&nbsp;environment&nbsp;vars</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>SYNOPSIS</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<span&nbsp;class='name'>_GetOpt&nbsp;%*</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>OPTIONS</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;-h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Usage/Help&nbsp;page&nbsp;and&nbsp;exit&nbsp;1&nbsp;(Hard&nbsp;coded)</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;-?&nbsp;/?&nbsp;&nbsp;&nbsp;Usage/Help&nbsp;page&nbsp;and&nbsp;exit&nbsp;1&nbsp;(Hard&nbsp;coded)</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;-!&nbsp;/!&nbsp;&nbsp;&nbsp;Debug&nbsp;on&nbsp;(Hard&nbsp;coded)&nbsp;&nbsp;&nbsp;See&nbsp;BUGS&nbsp;section.&nbsp;Use&nbsp;--Debug:1</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;-!-&nbsp;/!-&nbsp;Debug&nbsp;off&nbsp;(Hard&nbsp;coded)&nbsp;&nbsp;See&nbsp;BUGS&nbsp;section.&nbsp;Use&nbsp;--Debug:0</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>DESCRIPTION</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;Build&nbsp;named&nbsp;environment&nbsp;variables&nbsp;from&nbsp;command&nbsp;line&nbsp;options</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;Arguments&nbsp;can&nbsp;either&nbsp;be:</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simple&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Like&nbsp;a&nbsp;name&nbsp;with&nbsp;no&nbsp;prefix&nbsp;[filename]</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Letter&nbsp;prefixed&nbsp;with&nbsp;one&nbsp;valid&nbsp;flag&nbsp;prefix&nbsp;[-h]</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Combined&nbsp;&nbsp;&nbsp;&nbsp;Option&nbsp;with&nbsp;a&nbsp;value&nbsp;separated&nbsp;by&nbsp;colon&nbsp;[-f:name]</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Long&nbsp;option&nbsp;[--help]</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Long&nbsp;comb.&nbsp;&nbsp;Long&nbsp;option&nbsp;with&nbsp;a&nbsp;value&nbsp;[--file:name]</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;Valid&nbsp;flag&nbsp;prefixes&nbsp;are&nbsp;&nbsp;"-"&nbsp;or&nbsp;"/".</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;seperator&nbsp;between&nbsp;option&nbsp;and&nbsp;value&nbsp;can&nbsp;only&nbsp;be&nbsp;colon&nbsp;since</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;WinDOS&nbsp;will&nbsp;treat&nbsp;=&nbsp;as&nbsp;a&nbsp;blank.</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;$NAME&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;environment&nbsp;var&nbsp;"UNDEFINED"&nbsp;is&nbsp;used&nbsp;as&nbsp;$NAME</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Simple&nbsp;argument&nbsp;stored&nbsp;in&nbsp;sequential&nbsp;numbered&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;environment&nbsp;variables:&nbsp;@UNDEFINED.1=filename</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-file:filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Combined&nbsp;argument:&nbsp;@UNDEFINED.file=filename</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/file:filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Combined&nbsp;argument:&nbsp;@UNDEFINED.file=filename</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--//file:filename&nbsp;&nbsp;&nbsp;Combined&nbsp;argument:&nbsp;@UNDEFINED.file=filename</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;NOTE!</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;you&nbsp;entend&nbsp;to&nbsp;nest&nbsp;scripts&nbsp;both&nbsp;using&nbsp;<span&nbsp;class='name'>_GetOpt&nbsp;you&nbsp;must&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start&nbsp;the&nbsp;nested&nbsp;script&nbsp;with&nbsp;a&nbsp;SETLOCAL&nbsp;statement&nbsp;to&nbsp;preserve</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;callers&nbsp;environment!</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>EXAMPLES:</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;$NAME=x</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::Parse&nbsp;options&nbsp;to&nbsp;current&nbsp;script</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<span&nbsp;class='name'>_GetOpt&nbsp;%*</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::Show&nbsp;options</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;@x</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::Clear&nbsp;env&nbsp;vars</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<span&nbsp;class='name'>_GetOpt</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;x.bat&nbsp;contains&nbsp;the&nbsp;statement:</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;$NAME=x</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<span&nbsp;class='name'>_GetOpt&nbsp;%*</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;@</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;Enable&nbsp;delayed&nbsp;expansion&nbsp;of&nbsp;vars&nbsp;to&nbsp;use&nbsp;content&nbsp;of&nbsp;vars</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECHO&nbsp;z=!@<span&nbsp;class='name'>_GetOpt.z!!&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SETLOCAL&nbsp;DISABLEDELAYEDEXPANSION</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;Or&nbsp;hard&nbsp;code&nbsp;reference</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ECHO&nbsp;a=%@x.z%</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;::&nbsp;Clear&nbsp;flags</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;<span&nbsp;class='name'>_GetOpt</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;Executing:&nbsp;x.bat&nbsp;-y:z&nbsp;-flag&nbsp;file&nbsp;-z:"hello&nbsp;world"</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;x.bat&nbsp;will&nbsp;have&nbsp;the&nbsp;environment:</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$x.x=yy</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x.z=1</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;x.bat&nbsp;-y:z&nbsp;-flag&nbsp;file&nbsp;-z:"hello&nbsp;world"</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x.1=file</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x.flag=1</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x.y=z</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@x.z="hello&nbsp;world"</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;NOTE:&nbsp;"-flag"&nbsp;and&nbsp;"file"&nbsp;are&nbsp;NOT&nbsp;combined</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>REQUIRES</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;_Debug.cmd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setting&nbsp;up&nbsp;debug&nbsp;environment&nbsp;for&nbsp;batch&nbsp;scripts&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>EXIT STATUS</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;OK</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;Usage&nbsp;(or&nbsp;error)</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>ENVIRONMENT</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;Will&nbsp;change&nbsp;environment&nbsp;according&nbsp;to&nbsp;the&nbsp;given&nbsp;arguments.</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;environment&nbsp;var&nbsp;DEBUG&nbsp;is&nbsp;defined&nbsp;and&nbsp;>&nbsp;1&nbsp;debug&nbsp;will&nbsp;be&nbsp;enabled&nbsp;as&nbsp;default.</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>BUGS / KNOWN PROBLEMS</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;-!&nbsp;and&nbsp;/!&nbsp;will&nbsp;activate&nbsp;debug&nbsp;and&nbsp;set&nbsp;env&nbsp;variable&nbsp;@x.debug=1</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;-!-&nbsp;and&nbsp;/!-&nbsp;will&nbsp;deactivate&nbsp;debug&nbsp;BUT&nbsp;set&nbsp;env&nbsp;variable&nbsp;@x.debug=1</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;!&nbsp;flags&nbsp;are&nbsp;not&nbsp;available&nbsp;if&nbsp;you&nbsp;use&nbsp;delayed&nbsp;expantion&nbsp;as&nbsp;in&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;SETLOCAL&nbsp;ENABLEDELAYEDEXPANSION</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>REQUIRES</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;_Debug.cmd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setting&nbsp;up&nbsp;debug&nbsp;environment&nbsp;for&nbsp;batch&nbsp;scripts&nbsp;</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;what.cmd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Show&nbsp;usage</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>REFERENCES:</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;https://en.wikipedia.org/wiki/Getopt</span></span></tt><BR>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;</span></span></tt><BR>
<h3>SOURCE</span></span></h3>
<tt>&nbsp;&nbsp;&nbsp;&nbsp;c:\Users\Erik\Documents\GitHub\Underscore\_GetOpt.cmd</span></span></tt><BR>
<h5>(c)2015 Erik Bachmann, ClicketyClick.dk (ErikBachmann@ClicketyClick.dk)</span></span></h5>

